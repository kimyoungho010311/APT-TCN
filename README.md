# 🏘️ 멀티 모달 데이터를 이용한 TCN 기반 시나리오별 아파트 가격 예측 연구
**(Multi-Modal TCN-Based Apartment Price Prediction under Scenario Analysis)**

본 저장소는 [멀티 모달 데이터를 이용한 TCN 기반 시나리오별 아파트 가격 예측 연구]의 공식 구현 코드입니다.

---

## 프로젝트 개요
| 항목 | 내용 |
|-----|-----|
|진행기간| 2025.01 ~ 2025.11 (약 11개월)|
|참여인원| 개인 연구(1인)|
|주요 역할| 데이터 파이프라인 구축, 멀티모달 모델링, 시나리오 로직 설계, 실험 및 검증|

## 1. 연구 하이라이트

### 핵심 성과
* **멀티모달 융합의 효과 입증:** 위성 이미지(비정형 데이터)를 추가함으로써 기존 정형 데이터 기반 모델 대비 **예측 오차(MAE)를 4.66% 감소**시켰습니다.
* **최적의 시계열 모델 선정:** GRU, LSTM, TCN 비교 실험을 통해 본 데이터셋에서 가장 우수한 성능을 보인 **TCN 기반 예측 모델**을 구축했습니다.
* **불확실성 대응 시나리오 예측:** 단일 예측이 아닌, 거시 경제 변화(낙관/중립/보수)에 따른 **3가지 미래 시나리오**를 제시하여 시장 불확실성에 대한 대응력을 높였습니다.

### ❓ 문제 정의
부동산은 대한민국 가계 자산의 75%를 차지하는 핵심 자산임에도 불구하고, 기존 예측 모델은 두 가지 명확한 한계를 가지고 있었습니다.
1. 데이터의 한계: 가격에 큰 영향을 미치는 '입지', '주변 환경'등 시각정 정보를 배제하고 수치 데이터에만 의존함
2. 예측의 한계: 금리 변동이나 경기 침체 같은 미래 불확실성을 고려하지 않고, 단 하나의 결정론적 결과만 제시함
👉 따라서, "위성 이미지를 통해 입지 가치를 반영하고, 시나리오를 통해 미래 불확실성에 대응할 수 없을까?"라는 질문에서 연구를 시작했습니다.

### 🎯 예상 결과물
- 멀티모달 시계열 모델: 정형 데이터(매매, 경제지표)와 비정형 데이터(위성 이미지)를 융합하여 기존 대비 정확도가 향상된 가격 예측 모델
- 시나리오 기반 예측 결과: 거시 경제(낙관/중립/보수) 변화에 따라 향후 12개월간 아파트 가격이 어떻게 변동할지 보여주는 시각화 결과

### 🧑‍💻 주요 역할 및 기여
본 프로젝트의 전과정을 단독으로 수행했습니다.
* **🛠️ Data Engineering:**
    * 국토교통부(매매) 및 한국은행(경제지표) API 데이터 수집 **파이프라인** 구축
    * GEE(Google Earth Engine)를 활용한 위성 이미지 수집 및 좌표 매핑
* **🤖 AI Modeling:**
    * **Dual-Encoder 아키텍처 설계:** MLP(정형) + ResNet-50(비정형) 융합 구조 구현
    * **TCN 모델 도입:** 기존 RNN 계열 대비 장기 의존성 문제를 해결한 Temporal Convolutional Network 적용
* **📈 Analysis:**
    * **시나리오 로직 구현:** **재귀적 예측** 알고리즘을 통해 경제 지표 가중치 누적 효과 구현
    * **실험 설계:** 위성 이미지 유무 및 모델별(GRU vs LSTM vs TCN) 성능 비교 검증 (MAE 기준)
---

## 2. 방법론 및 아키텍처 (Methodology & Architecture)

### 2.1 시스템 아키텍처
본 연구는 이종(Heterogeneous) 데이터를 효과적으로 처리하기 위해 **Dual-Encoder 구조**와 **TCN 기반 시계열 예측** 모델을 결합했습니다.

![System Architecture](https://github.com/kimyoungho010311/APT-TCN/blob/main/images/%EC%9C%A0%EC%8A%A4%EC%BC%80%EC%9D%B4%EC%8A%A4-%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90%20%EC%84%A4%EA%B3%84%20%EC%B5%9C%EC%A2%85.jpg?raw=true)

* **정형 인코더 (MLP):** 아파트 특성 및 거시 경제지표의 비선형적 관계 학습 (64차원 벡터로 압축)
* **비정형 인코더 (ResNet-50):** 위성 이미지에서 공간/시각적 특징 추출 (차원의 저주 방지를 위해 2048차원 → 32차원으로 압축)
* **특징 융합 (Fusion Layer):** 두 벡터를 결합하여 시계열 모델(TCN)의 입력으로 사용

### 2.2 데이터 구성 및 전처리
본 연구에서 사용된 데이터 구성은 다음과 같습니다.

<img width="100%" alt="Data Definition" src="https://github.com/user-attachments/assets/693f763d-f4b4-4d1b-9a4b-8e3ff73f7629" />

**[핵심 전처리 전략]**
* **스케일링:** `MinMaxScaler` 채택. 강남구 특성상 존재하는 초고가 매물(이상치)의 정보를 인위적으로 제거하지 않고 보존하기 위함입니다.
* **평가 지표:** `MAE(Mean Absolute Error)` 선정. 이상치에 민감한 다른 손실 함수들보다 모델의 일반적인 성능을 안정적으로 평가하기 적합합니다.

---

## 3. 실험 및 결과

### 3.1 멀티모달 융합 효과 검증
위성 이미지 특징 벡터를 결합한 **멀티모달 데이터**의 유효성을 검증하기 위해, 정형 데이터만을 사용한 **기준 모델**과 성능을 비교했습니다.

| 모델 구분 | 1개월 후 | 3개월 후 | 6개월 후 |
|--------|---------|--------|---------|
| 기준 모델 | 7.486  | 7.487  | 7.236   |
| 멀티모달 융합 모델 | 7.137 | 7.212 | 7.156 |
| 감소율 | 4.66% | 3.67% | 1.11% |

> 이번 실험으로 멀티모달 데이터의 유효성을 입증했습니다.

### 3.2 시계열 예측 모델 성능 비교
멀티모달 데이터를 학습시키는 데 최적인 시계열 모델을 선정하기 위해, LSTM, GRU, TCN 세 가지 모델의 성능을 비교했습니다.

| 모델 구분 | 1개월 후 MAE | 3개월 후 MAE | 6개월 후 MAE |
|---|---|---|---|
| LSTM | 7.305 | 7.288 | 7.351 | 
| GRU | 7.237 | 7.215 | 7.290 | 
| **TCN** | **7.219** | **7.195** | **7.233** |

> 모든 구간에서 가장 낮은 MAE를 기록했습니다. 따라서 TCN을 최종 예측 모델로 선정했습니다.


### 3.3 시나리오 기반 미래 예측
선정된 TCN 모델을 사용하여 3가지 경제 시나리오(낙관/중립/보수)에 따른 미래 12개월 아파트 가격을 예측했습니다.

**[시나리오 설계 및 예측 방법]**
* **시나리오 정의:** 경기선행지수, 기준 금리 등 핵심 거시 경제지표에 대해 시나리오별 **월별 가중치(Weight)** 를 설정했습니다.
* **재귀적 예측 (Recursive Prediction):** 미래 데이터를 예측하기 위해 직전 시점의 예측값과 가중치가 적용된 경제지표를 다음 시점의 입력으로 사용했습니다.
    * 수식: $E_{t+1} = E_{t} \times W_{scenario}$ (시간이 지날수록 시나리오 간 격차가 누적되는 구조)

<img width="80%" alt="Scenario Prediction Result" src="https://github.com/user-attachments/assets/b94df0c4-bd1e-471a-975a-d52e7d9999d6" />

> **결과 해석:** 초기에는 과거 데이터의 영향으로 유사한 흐름을 보이나, 시간이 지날수록 시나리오별 경제지표의 누적 효과로 인해 가격 격차가 확대되는 경향을 보였습니다. 이는 본 시스템이 미래 시장의 불확실성을 효과적으로 반영할 수 있음을 시사합니다.

---

## 4. 결론 (Conclusion)

본 연구는 **위성 이미지 기반의 멀티모달 학습**과 **TCN 모델**을 통해 예측 정확도를 입증하고, **시나리오 분석**을 접목하여 미래 시장의 불확실성에 대응하는 실용적인 예측 프레임워크를 제시하였습니다.

실험 결과, 위성 이미지 융합과 TCN 모델 도입을 통해 기존 모델 대비 우수한 예측 성능을 달성하였습니다. 나아가 거시 경제 시나리오에 따른 미래 가격 변동 범위를 제시함으로써, 실질적인 의사결정을 지원하는 모델의 가치를 입증하였습니다.
